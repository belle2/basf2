Here are instruction for running validation of newly produced simulations for Charmless B Decay physics group.
Validation consist of two steps: production of nTuples and nTuple analysis

1. Production of nTuples
    a.  To produce nTuples, make sure you know how to work with gbasf2:
        https://confluence.desy.de/pages/viewpage.action?pageId=47819144

    b.  Go to Rec/ directory and submit gb2 jobs:
        > cd Rec
        > gbasf2 Rec_Bu_Rho0Kst+_K+pi0_gb2.py -i <Address of transverse-polarized samples> -f aliases.py BTools.py -p Kpi0_T
        > gbasf2 Rec_Bu_Rho0Kst+_K+pi0_gb2.py -i <Address of longitudinaly-polarized samples> -f aliases.py BTools.py -p Kpi0_L
        N.B. Scripts are created for basf2 release-00-08-00. If release version will change, you will might need to update them.

    c.  Once jobs are completed, download otuput tuples:
        > gb2_ds_get /belle/user/$USER/Kpi0_T
        > gb2_ds_get /belle/user/$USER/Kpi0_L

    d.  Merge outputs:
        > hadd Bu_Rho0Kst+_K+pi0_Transverse.root Kpi0_T/*.root
        > hadd Bu_Rho0Kst+_K+pi0_Longitudinal.root Kpi0_L/*.root
        > hadd Bu_Rho0Kst+_K+pi0.root Bu_Rho0Kst+_K+pi0_Transverse.root Bu_Rho0Kst+_K+pi0_Longitudinal.root

    N.B. As a result of this step, you will have Bu_Rho0Kst+_K+pi0_Transverse.root and Bu_Rho0Kst+_K+pi0_Longitudinal.root stred in Rec/ direcotry.
    This file location is important since next step of validation will read files from this location. If you change it, please make sure you indicate new loaction at Ana/Global/paths.py

2. Tuple analysis (Beware, it takes ~3h for 2M+2M sample.)
    a.  Before you start, make sure you are using python 3 and pyRoot. The easiest way to do so is to setup basf2 environment in you favorite way (i.e. make sure that basf2 works, this will be ebough to run scripts). Once it's done, go to Ana directory. This will be core directory for the tuple analysis.
        > cd Ana

    b.  Make summary of sample yields and reconstruction efficiencies
        > ipython Make_Summary.py

    c.  Plot distributions of important variables and do resolution study
        > cd Decorations
        > ipython Validation_Study.py

    d.  Make correlation study
        > cd ../Correlations
        > ipython SliceAnalysis.py

    e.  Compile report
        > cd ../Report/
        > pdflatex Summary.tex
        > pdflatex Summary.tex 

    f.  Results of validation study will be summarized in the Report/Summary.pdf document

    FAQ:
    Q: I want to change selection used in validation process, what should I do?
    A: All cuts are described in Global/cuts.py file. Currently selection is done with "cut_Kpi0" cut, so the easiest way would be to modify content of this cut. Please make sure you made corresponding changes also in Make_Summary.py file (to obtain correct cut efficiency table).

    Q: I modified nTuple algorithm, and some variable names have changed. What should I do?
    A: Modify tuple names in the Global/fit_variales.py and Global/selection_variables.py files. If you changed names variables which you cut on, you also need to modigy Global/cuts.py file.

    N.B. If you have a question regarding the package, something doesn't work or you want to add or change something but not sure how, please contact Ilya Komarov (ilya.komarov@desy.de).  

