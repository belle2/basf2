#!/usr/bin/env python
import os
from DataSetUtil import *
import sys
def main():
	dsparam=DSParam(sys.argv[0])
	dsparam.register_param()
	from DIRAC.Core.Base import Script
	Script.parseCommandLine(ignoreErrors=True)
	Project=dsparam.getProject()
	User=dsparam.getUser()
	dstdir=dsparam.getDstDir()
	dspath="/belle2/user/belle/"+User+"/"+Project
	from DataSetOp import ds_get
	from AmgaClient import AmgaClient

	aclient = AmgaClient()
        entries = aclient.getAttributesValues(dspath,['lfn'])
	if entries is False:
                print "dataset %s does not exisit"%dspath
                sys.exit(-1)
	if dstdir=="":
		dstdir="/tmp/"
	a=dspath.split("/")
	ds_dir=dstdir+"/"+"_".join(a[-2:])
	if not os.path.exists(ds_dir):
		os.mkdir(ds_dir)

	ds_get(entries,ds_dir)

if  __name__ == '__main__':
    main()

