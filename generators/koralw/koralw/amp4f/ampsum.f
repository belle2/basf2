* File ampsum.f generated by GRACE Ver. 2.00(35)        1996/03/24/15:33
* 
*          Fortran source code generator
*     (c)copyright 1990-1996 Minami-Tateya Group, Japan
*-----------------------------------------------------------------------
************************************************************************
*     CF version 
************************************************************************
      subroutine ampsum(ans)
      implicit DOUBLE PRECISION(a-h,o-z)
      include 'incl1.f'
      include 'inclk.f'
      DOUBLE PRECISION     ans
      DOUBLE COMPLEX anc
*-----------------------------------------------------------------------
      jsum = 1
      do 10 ie = 1, nextn
        jsum = jsum*(jhe(ie) - jhs(ie) + 1)
   10 continue

      anc = 0

      if( kmcbas .eq. 2 ) then
*     sum over helicities
      do 100 ind = 0, jsum - 1

*       sum over color bases
        anc = anc  + cfmtx(0,0)*agc(ind,0)*conjg(agc(ind,0))
     .               + cfmtx(0,1)*agc(ind,0)*conjg(agc(ind,1))
     .               + cfmtx(1,0)*agc(ind,1)*conjg(agc(ind,0))
     .               + cfmtx(1,1)*agc(ind,1)*conjg(agc(ind,1))
  100 continue
      ans = anc

      else

*     sum over helicities
      do 200 ind = 0, jsum - 1
*       sum over color bases
        anc = anc  + agc(ind,0)*conjg(agc(ind,0))
  200 continue

*     print *,'--ampsum-- anc ',anc
*     print *,'--ampsum--cfmtx(0,0) ',cfmtx(0,0)
      ans = cfmtx(0,0)*anc

      endif

      return
      end
