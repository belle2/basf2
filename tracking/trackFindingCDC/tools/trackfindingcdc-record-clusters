#!/usr/bin/env python
# -*- coding: utf-8 -*-

import os
import sys
import os.path
import basf2

from trackfindingcdc.validation.recording import RecordingRun

import logging


class CDCClusterRecordingRun(RecordingRun):
    """Run for recording clusters encountered at the filter"""
    n_events = 50
    bkg_files = os.path.join(os.environ["VO_BELLE2_SW_DIR"], "bkg")

    output_file_name = "CDCClusterTruthRecords.root"
    varsets = ["basic", "truth", ]

    recording_filter_parameter_name = "ClusterFilterParameters"

    recording_finder_module = basf2.register_module("SegmentFinderCDCFacetAutomatonDev")

    recording_finder_module.param({
        "ClusterFilter": "unionrecording",
        recording_filter_parameter_name : {
            "root_file_name": output_file_name,
            "varsets": ",".join(varsets),
        },
        "FacetFilter": "none",
        "FacetRelationFilter": "none",
    })


def main():
    run = CDCClusterRecordingRun()
    run.configure_and_execute_from_commandline()


if __name__ == "__main__":
    logging.basicConfig(stream=sys.stdout, level=logging.INFO, format='%(levelname)s:%(message)s')
    main()
